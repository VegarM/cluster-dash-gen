{
    "dashboard": {
        "id": null,
        "title": "NAIS {{cluster}} cluster dashboard",
        "tags": [
            "kubernetes",
            "nais"
        ],
        "timezone": "browser",
        "rows": [
            {
                "repeating": false,
                "nodes": null,
                "config": {
                    "collapse": false,
                    "height": 200,
                    "title": "Cluster"
                },
                "panels": [
                    {
                        "panel": "text",
                        "text": "{{cluster}}",
                        "width": 6
                    }
                ]
            },
            {
                "repeating": false,
                "nodes": null,
                "config": {
                    "collapse": false,
                    "height": 100,
                    "title": "Deployments"
                },
                "panels": [
                    {
                        "panel": "singleStat",
                        "title": "No of pods",
                        "datasource": "{{cluster}}",
                        "measurement": "kubePodContainerInfoCount",
                        "width": 2
                    },
                    {
                        "panel": "singleStat",
                        "title": "Pending pods",
                        "datasource": "{{cluster}}",
                        "measurement": "kubePodStatusPhasePending",
                        "width": 2
                    },
                    {
                        "panel": "singleStat",
                        "title": "Available deployments",
                        "datasource": "{{cluster}}",
                        "measurement": "kubeDeploymentsStatusReplicasAvailable",
                        "width": 2
                    },
                    {
                        "panel": "singleStat",
                        "title": "Available deployments",
                        "datasource": "{{cluster}}",
                        "measurement": "kubeDeploymentsStatusReplicasAvailable",
                        "width": 2
                    },                    
                    {
                        "panel": "singleStat",
                        "title": "Unavailable deployments",
                        "datasource": "{{cluster}}",
                        "measurement": "kubeDeploymentsStatusReplicasUnavailable",
                        "width": 2
                    }
                ]
            },
            {
                "repeating": false,
                "nodes": null,
                "config": {
                    "collapse": false,
                    "height": 100,
                    "title": "Cluster metrics"
                },
                "panels": [
                    {
                        "panel": "singleStat",
                        "title": "Cores usage",
                        "datasource": "{{cluster}}",
                        "postfix": "cores",
                        "measurement": "totalClusterCoresUsage",
                        "width": 2
                    },
                    {
                        "panel": "singleStat",
                        "title": "Total CPU",
                        "datasource": "{{cluster}}",
                        "postfix": "cores",
                        "measurement": "totalClusterCores",
                        "width": 2
                    },
                    {
                        "panel": "singleStat",
                        "title": "Memory usage",
                        "datasource": "{{cluster}}",
                        "postfix": "GB",
                        "measurement": "totalClusterMemoryUsage",
                        "width": 2
                    },
                    {
                        "panel": "singleStat",
                        "title": "Total memory",
                        "datasource": "{{cluster}}",
                        "postfix": "GB",
                        "measurement": "totalClusterMemory",
                        "width": 2
                    },
                    {
                        "panel": "singleStat",
                        "title": "Storage usage",
                        "datasource": "{{cluster}}",
                        "postfix": "GB",
                        "measurement": "totalClusterStorageUsage",
                        "width": 2
                    },
                    {
                        "panel": "singleStat",
                        "title": "Total storage",
                        "datasource": "{{cluster}}",
                        "postfix": "?",
                        "measurement": "totalClusterStorage",
                        "width": 2
                    }
                ]
            },
            {
                "repeating": false,
                "nodes": null,
                "config": {
                    "collapse": false,
                    "height": 200,
                    "title": "Cluster metrics"
                },
                "panels": [
                    {
                        "panel": "singleStat",
                        "subtype": "gauge",
                        "title": "CPU usage",
                        "postfix": "%",
                        "datasource": "{{cluster}}",
                        "measurement": "totalClusterCoresUsagePercent",
                        "width": 4
                    },
                    {
                        "panel": "singleStat",
                        "subtype": "gauge",
                        "title": "Memory usage",
                        "postfix": "%",
                        "datasource": "{{cluster}}",
                        "measurement": "totalClusterMemoryUsagePercent",
                        "width": 4
                    },
                    {
                        "panel": "singleStat",
                        "subtype": "gauge",
                        "title": "Storage usage",
                        "postfix": "%",
                        "datasource": "{{cluster}}",
                        "measurement": "totalClusterStorageUsagePercent",
                        "width": 4
                    },
                    {
                        "panel": "singleStat",
                        "subtype": "gauge",
                        "title": "Allocated cores",
                        "datasource": "{{cluster}}",
                        "postfix": "%",
                        "measurement": "totalClusterCoresAllocatedPercent",
                        "width": 4
                    },
                    {
                        "panel": "singleStat",
                        "subtype": "gauge",
                        "title": "Allocated memory",
                        "datasource": "{{cluster}}",
                        "postfix": "%",
                        "measurement": "totalClusterMemoryAllocatedPercent",
                        "width": 4
                    }
                ]
            },
            {
                "repeating": false,
                "nodes": null,
                "config": {
                    "collapse": false,
                    "height": 80,
                    "title": "Master nodes:",
                    "showTitle": true
                },
                "panels": [
                    {
                        "panel": "singleStat",
                        "subtype": "healthCheck",
                        "width": 2,
                        "nodes": "{{masters}}",
                        "measurement": "aggregate"
                    }
                ]
            },
            {
                "repeating": false,
                "nodes": null,
                "config": {
                    "collapse": false,
                    "height": 80,
                    "title": "Worker nodes:",
                    "showTitle": true
                },
                "panels": [
                    {
                        "panel": "singleStat",
                        "subtype": "healthCheck",
                        "nodes": "{{workers}}",
                        "width": 2,
                        "measurement": "aggregate"
                    }
                ]
            },
            {
                "repeating": false,
                "nodes": null,
                "config": {
                    "collapse": false,
                    "height": 400,
                    "showTitle": false
                },
                "panels": [
                    {
                        "panel": "graph",
                        "nodes": "{{nodes}}",
                        "measurement": [
                            "cpuIdle"
                        ],
                        "title": "Cluster CPU Load"
                    },
                    {
                        "panel": "graph",
                        "nodes": "{{nodes}}",
                        "measurement": "diskVarUsage",
                        "title": "Cluster Disk Usage (/var)"
                    },
                    {
                        "panel": "graph",
                        "nodes": "{{nodes}}",
                        "measurement": "memoryUsageWOBuffersCaches",
                        "title": "Cluster Memory Usage"
                    }
                ]
            },
            {
                "repeating": true,
                "nodes": "{{masters}}",
                "config": {
                    "collapse": true,
                    "height": 400,
                    "title": "Master node:",
                    "showTitle": true
                },
                "panels": [
                    {
                        "panel": "discrete",
                        "nodes": null,
                        "title": "Master node component status",
                        "measurement": [
                            "processDockerd",
                            "processKubelet",
                            "interfaceDocker0",
                            "interfaceFlannel",
                            "componentControllerManager",
                            "componentScheduler",
                            "componentEtcd0",
                            "addonCoredns",
                            "addonKubernetesDashboard",
                            "addonTillerDeploy"
                        ]
                    },
                    {
                        "panel": "graph",
                        "nodes": null,
                        "measurement": "cpuIdle",
                        "title": "Node CPU Load"
                    },
                    {
                        "panel": "graph",
                        "nodes": null,
                        "measurement": "diskVarUsage",
                        "title": "Node Disk Usage (/var)"
                    },
                    {
                        "panel": "graph",
                        "nodes": null,
                        "stack": true,
                        "measurement": [
                            "memoryUsageWOBuffersCaches",
                            "memoryPercentCached"
                        ],
                        "title": "Node Memory Usage"
                    }
                ]
            },
            {
                "repeating": true,
                "nodes": "{{workers}}",
                "config": {
                    "collapse": true,
                    "height": 400,
                    "title": "Worker node:",
                    "showTitle": true
                },
                "panels": [
                    {
                        "panel": "discrete",
                        "nodes": null,
                        "title": "Worker node component status",
                        "measurement": [
                            "processDockerd",
                            "processKubelet",
                            "processFlanneld",
                            "processKubeProxy",
                            "interfaceDocker0",
                            "interfaceFlannel"
                        ]
                    },
                    {
                        "panel": "graph",
                        "nodes": null,
                        "measurement": "cpuIdle",
                        "title": "Node CPU Load"
                    },
                    {
                        "panel": "graph",
                        "nodes": null,
                        "measurement": "diskVarUsage",
                        "title": "Node Disk Usage (/var)"
                    },
                    {
                        "panel": "graph",
                        "nodes": null,
                        "stack": true,
                        "measurement": [
                            "memoryUsageWOBuffersCaches",
                            "memoryPercentCached"
                        ],
                        "title": "Node Memory Usage"
                    }
                ]
            }
        ],
        "schemaVersion": 6,
        "version": 0
    },
    "overwrite": true
}